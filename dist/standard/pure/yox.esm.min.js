const t="undefined"!=typeof window?window:undefined,e="undefined"!=typeof global?global:t,n=function(){},r=Object.freeze({}),i=Object.freeze([]);function s(t){return"function"==typeof t}function o(t){return Array.isArray(t)}function c(t){return null!==t&&"object"==typeof t}function u(t){return"string"==typeof t}function f(t){return"number"==typeof t&&!isNaN(t)}function a(t){return"boolean"==typeof t}function l(t){return f(t)||u(t)&&!isNaN(parseFloat(t))&&isFinite(t)}var h=Object.freeze({__proto__:null,func:s,array:o,object:c,string:u,number:f,boolean:a,numeric:l});function p(t,e,n){if(s(t))return o(n)?t.apply(e,n):undefined!==e?t.call(e,n):undefined!==n?t(n):t()}class d{constructor(t,e){this.type=t,this.phase=d.PHASE_CURRENT,e&&(this.originalEvent=e)}static is(t){return t instanceof d}preventDefault(){const t=this;if(!t.isPrevented){const{originalEvent:e}=t;e&&e.preventDefault(),t.isPrevented=true}return t}stopPropagation(){const t=this;if(!t.isStoped){const{originalEvent:e}=t;e&&e.stopPropagation(),t.isStoped=true}return t}prevent(){return this.preventDefault()}stop(){return this.stopPropagation()}}function g(t,e,n){const{length:r}=t;if(r)if(n)for(let n=r-1;n>=0&&false!==e(t[n],n);n--);else for(let n=0;n<r&&false!==e(t[n],n);n++);}function v(t,e){t[t.length]=e}function y(t,e){t.unshift(e)}function m(t,e,n){o(e)?g(e,(function(e){n(t,e)})):n(t,e)}function b(t,e){m(t,e,v)}function w(t,e){m(t,e,y)}function x(t,e,n){let r=-1;return g(t,(function(t,i){if(false===n?t==e:t===e)return r=i,false})),r}function E(t,e,n){let r=0;return g(t,(function(i,s){(false===n?i==e:i===e)&&(t.splice(s,1),r++)}),true),r}function $(t,e,n){return x(t,e,n)>=0}function _(t){return!o(t)||!t.length}d.PHASE_CURRENT=0,d.PHASE_UPWARD=1,d.PHASE_DOWNWARD=-1;var A=Object.freeze({__proto__:null,each:g,push:b,unshift:w,indexOf:x,last:function(t){const{length:e}=t;if(e>0)return t[e-1]},pop:function(t){const{length:e}=t;if(e>0)return t.pop()},remove:E,has:$,toArray:function(t){return o(t)?t:p(i.slice,t)},toObject:function(t,e,n){let r={};return g(t,(function(t){r[e?t[e]:t]=n||t})),r},join:function(t,e){return t.join(e)},falsy:_});const O=/-([a-z])/gi,k=/\B([A-Z])/g,C=/^[a-z]/,j={},P={},R={};function z(t,e,n){return f(n)?e===n?"":t.slice(e,n):t.slice(e)}function S(t,e,n){return t.indexOf(e,undefined!==n?n:0)}function T(t,e,n){return t.lastIndexOf(e,undefined!==n?n:t.length)}function D(t,e){return 0===S(t,e)}function N(t,e){return t.charCodeAt(e||0)}function W(t){return t.toUpperCase()}function F(t){return t.toLowerCase()}function U(t,e){return S(t,e)>=0}function H(t){return!u(t)||!t.length}var I=Object.freeze({__proto__:null,camelize:function(t){return j[t]||(j[t]=t.replace(O,(function(t,e){return W(e)}))),j[t]},hyphenate:function(t){return P[t]||(P[t]=t.replace(k,(function(t,e){return"-"+F(e)}))),P[t]},capitalize:function(t){return R[t]||(R[t]=t.replace(C,W)),R[t]},trim:function(t){return H(t)?"":t.trim()},slice:z,indexOf:S,lastIndexOf:T,startsWith:D,endsWith:function(t,e){const n=t.length-e.length;return n>=0&&T(t,e)===n},charAt:function(t,e){return t.charAt(e||0)},codeAt:N,upper:W,lower:F,has:U,falsy:H});const Y=/\./g,L=/\*/g,M=/\*\*/g,q={},B={};function G(t,e){let n;o(q[t])?n=q[t]:(n=S(t,".")<0?[t]:t.split("."),q[t]=n);for(let t=0,r=n.length-1;t<=r&&false!==e(n[t],t,r);t++);}function V(t,e){let n=B[e];if(!n){const t=e.replace(Y,"\\.").replace(L,"(\\w+)").replace(M,"([.\\w]+?)");n=B[e]=new RegExp(`^${t}$`)}const r=t.match(n);if(r)return r[1]}const X={value:undefined};function Z(t){return Object.keys(t)}function J(t,e){for(let n in t)if(false===e(t[n],n))break}function K(t){J(t,(function(e,n){delete t[n]}))}function Q(t,e){return J(e,(function(e,n){t[n]=e})),t}function tt(t,e){let n=t;return o(t)?e?(n=[],g(t,(function(t,r){n[r]=tt(t,e)}))):n=t.slice():c(t)&&(n={},J(t,(function(t,r){n[r]=e?tt(t,e):t}))),n}function et(t,e){return G(e,(function(e,n,r){if(null==t)return t=undefined,false;{let i=t[e],o=undefined!==i;i&&s(i.get)&&(i=i.get()),n===r?o?(X.value=i,t=X):t=undefined:t=i}})),t}function nt(t,e){return undefined!==t[e]}var rt=Object.freeze({__proto__:null,keys:Z,each:J,clear:K,extend:Q,merge:function(t,e){return t&&e?Q(Q({},t),e):t||e},copy:tt,get:et,set:function(t,e,n,r){G(e,(function(e,i,s){if(i===s)t[e]=n;else if(t[e])t=t[e];else{if(!r)return false;t=t[e]={}}}))},has:nt,falsy:function(t){return!c(t)||o(t)||!Z(t).length}});function it(t,e){return null!=t&&t.toString?t.toString():undefined!==e?e:""}const st="undefined"!=typeof console?console:null,ot=/yox/.test(it(n))?2:3,ct=t&&/edge|msie|trident/i.test(t.navigator.userAgent)?"":"%c",ut=st?ct?function(t,e,n){st.log(ct+t,n,e)}:function(t,e){st.log(t,e)}:n;function ft(){if(e){const t=e.YOX_LOG_LEVEL;if(t>=1&&t<=5)return t}return ot}function at(t){return`background-color:${t};border-radius:12px;color:#fff;font-size:10px;padding:3px 6px;`}var lt=Object.freeze({__proto__:null,DEBUG:1,INFO:2,WARN:3,ERROR:4,FATAL:5,debug:function(t,e){ft()<=1&&ut(e||"Yox debug",t,at("#999"))},info:function(t,e){ft()<=2&&ut(e||"Yox info",t,at("#2db7f5"))},warn:function(t,e){ft()<=3&&ut(e||"Yox warn",t,at("#f90"))},error:function(t,e){ft()<=4&&ut(e||"Yox error",t,at("#ed4014"))},fatal:function(t,e){if(ft()<=5)throw new Error(`[${e||"Yox fatal"}]: ${t}`)}});class ht{constructor(t){this.ns=t||false,this.listeners={}}fire(t,e,n){let r=this,i=u(t)?r.toEvent(t):t,s=r.listeners[i.type],o=true;if(s){s=s.slice();const t=e&&d.is(e[0])?e[0]:undefined;for(let c=0,u=s.length;c<u;c++){let u=s[c];if(!dt(i.ns,u)||!$(s,u)||n&&!n(i,e,u))continue;t&&(t.listener=u.listener);let f=p(u.listener,u.ctx,e);if(t&&(t.listener=undefined),u.num=u.num?u.num+1:1,u.num===u.max&&r.off(i.type,{ns:i.ns,listener:u.listener}),t&&(false===f?t.prevent().stop():t.isStoped&&(f=false)),false===f){o=false;break}}}return o}on(t,e){const n=this,r=n.listeners,i=s(e)?{listener:e}:e;if(c(i)&&s(i.listener)){if(!u(i.ns)){const e=n.toEvent(t);i.ns=e.ns,t=e.type}b(r[t]||(r[t]=[]),i)}}off(t,e){const n=this,r=n.listeners;if(t){const i=n.toFilter(t,e),s=function(t,e){g(t,(function(e,n){pt(i.listener,e)&&dt(i.ns,e)&&t.splice(n,1)}),true),t.length||delete r[e]};i.type?r[i.type]&&s(r[i.type],i.type):i.ns&&J(r,s)}else n.listeners={}}has(t,e){let n=this.listeners,r=this.toFilter(t,e),i=true,s=function(t){return g(t,(function(t){if(pt(r.listener,t)&&dt(r.ns,t))return i=false})),i};return r.type?n[r.type]&&s(n[r.type]):r.ns&&J(n,s),!i}toEvent(t){const e={type:t,ns:""};if(this.ns){const n=S(t,".");n>=0&&(e.type=z(t,0,n),e.ns=z(t,n+1))}return e}toFilter(t,e){let n;if(n=e?s(e)?{listener:e}:e:{},u(n.ns))n.type=t;else{const e=this.toEvent(t);n.type=e.type,n.ns=e.ns}return n}}function pt(t,e){return!t||t===e.listener}function dt(t,e){const{ns:n}=e;return!n||!t||n===t}function gt(t){return s(t)&&U(it(t),"[native code]")}let vt;"function"==typeof setImmediate&&gt(setImmediate)&&(vt=setImmediate),vt="function"==typeof MessageChannel&&gt(MessageChannel)?function(t){const e=new MessageChannel;e.port1.onmessage=t,e.port2.postMessage(1)}:setTimeout;var yt=vt;let mt;class bt{constructor(){this.tasks=[]}static shared(){return mt||(mt=new bt)}append(t,e){const n=this,{tasks:r}=n;b(r,{fn:t,ctx:e}),1===r.length&&yt((function(){n.run()}))}prepend(t,e){const n=this,{tasks:r}=n;w(r,{fn:t,ctx:e}),1===r.length&&yt((function(){n.run()}))}clear(){this.tasks.length=0}run(){const{tasks:t}=this;t.length&&(this.tasks=[],g(t,(function(t){p(t.fn,t.ctx)})))}}function wt(t,e){return l(t)?+t:undefined!==e?e:0}class xt{constructor(t,e,n,r,i,s,o){const c=this;c.keypath=t,c.cache=n,c.deps=r,c.context=i.context,c.observer=i,c.getter=s,c.setter=o,c.unique={},c.watcher=function(e,n,r){const s=c.value,o=c.get(true);o!==s&&i.diff(t,o,s)},c.watcherOptions={sync:e,watcher:c.watcher},(c.fixed=!_(r))&&g(r,(function(t){i.watch(t,c.watcherOptions)}))}get(t){const e=this,{getter:n,context:r}=e;if(e.cache){if(t||!nt(e,"value"))if(e.fixed)e.value=p(n,r);else{e.unbind();const t=xt.current;xt.current=e,e.value=p(n,r),e.bind(),xt.current=t}}else e.value=p(n,r);return e.value}set(t){const{setter:e,context:n}=this;e&&e.call(n,t)}add(t){this.unique[t]=true}bind(){const{unique:t,deps:e,observer:n,watcherOptions:r}=this;J(t,(function(t,i){b(e,i),n.watch(i,r)})),this.unique={}}unbind(){const{deps:t,observer:e,watcher:n}=this;g(t,(function(t){e.unwatch(t,n)}),true),t.length=0}}function Et(t,e){if(null==t||""===e)return t;const n=et(t,e);return n?n.value:void 0}function $t(t,e,n,i,s){const f=function(e,n,r){if(n!==r){const u=(c=e,(o=t)&&c?o+"."+c:o||c);g(i,(function(t){undefined!==V(u,t)&&s(t,u,n,r)})),$t(u,n,r,i,s)}var o,c};(function(t,e,n){const r=u(t),i=u(e);if(r||i)return n("length",r?t.length:void 0,i?e.length:void 0),!0})(e,n,f)||function(t,e,n){const r=o(t),i=o(e);if(r||i){const s=r?t.length:void 0,o=i?e.length:void 0;n("length",s,o);for(let r=0,i=Math.max(s||0,o||0);r<i;r++)n(""+r,t?t[r]:void 0,e?e[r]:void 0);return!0}}(e,n,f)||function(t,e,n){const i=c(t),s=c(e);(i||s)&&(t=i?t:r,e=s?e:r,i&&J(t,(function(t,r){t!==e[r]&&n(r,t,e[r])})),s&&J(e,(function(e,r){e!==t[r]&&n(r,t[r],e)})))}(e,n,f)}function _t(t,e,n,r,i,s){let o;J(r,(function(r,c){if(function(t){return U(t,"*")}(c))return void(undefined!==V(t,c)?s(c,t,e,n):i&&(o?b(o,c):o=[c]));const u=function(t,e){return t===e||D(t,e+=".")?e.length:-1}(c,t);if(u>=0){const t=z(c,u),r=Et(e,t),i=Et(n,t);r!==i&&s(c,c,r,i)}})),o&&$t(t,e,n,o,s)}function At(t,e,n){if(n.count&&e)return n.count--,e[0]!==e[1]}const Ot={watcher:n};function kt(t,e){return s(t)?(Ot.watcher=t,Ot.immediate=true===e,Ot):t&&t.watcher?t:void 0}class Ct{constructor(t,e){const n=this;n.data=t||{},n.context=e||n,n.nextTask=new bt,n.syncEmitter=new ht,n.asyncEmitter=new ht,n.asyncChanges={}}get(t,e,n){const r=xt.current,{data:i,computed:s}=this;if(""===t)return i;let o;return r&&!n&&r.add(t),s&&(o=et(s,t)),o||(o=et(i,t)),o?o.value:e}set(t,e){const n=this,{data:r,computed:i}=n,s=function(t,e){const s=n.get(e);if(t===s)return;let o;G(e,(function(e,n,s){0!==n?o&&(n===s?o[e]=t:o=o[e]||(o[e]={})):i&&i[e]?0===s?i[e].set(t):o=i[e].get():0===s?r[e]=t:o=r[e]||(r[e]={})})),n.diff(e,t,s)};u(t)?s(e,t):c(t)&&J(t,s)}diff(t,e,n){const r=this,{syncEmitter:i,asyncEmitter:s,asyncChanges:o}=r,c=36!==N(t);_t(t,e,n,i.listeners,c,(function(t,e,n,r){i.fire({type:t,ns:""},[n,r,e])})),_t(t,e,n,s.listeners,c,(function(t,e,n,i){g(s.listeners[t],(function(t){t.count++}));const{keypaths:c}=o[e]||(o[e]={value:i,keypaths:[]});$(c,t)||b(c,t),r.pending||(r.pending=true,r.nextTask.append((function(){r.pending&&(r.pending=undefined,r.diffAsync())})))}))}diffAsync(){const t=this,{asyncEmitter:e,asyncChanges:n}=t;t.asyncChanges={},J(n,(function(n,r){const i=[t.get(r),n.value,r];g(n.keypaths,(function(t){e.fire({type:t,ns:""},i,At)}))}))}addComputed(t,e){let n,r,i=true,u=true,f=[];if(s(e))n=e;else if(c(e)){const t=e;a(t.cache)&&(i=t.cache),a(t.sync)&&(u=t.sync),o(t.deps)&&(f=tt(t.deps)),s(t.get)&&(n=t.get),s(t.set)&&(r=t.set)}if(n){const e=this,s=new xt(t,u,i,f,e,n,r);return e.computed||(e.computed={}),e.computed[t]=s,s}}removeComputed(t){const{computed:e}=this;e&&nt(e,t)&&delete e[t]}watch(t,e,n){const r=this,{context:i,syncEmitter:s,asyncEmitter:o}=r,c=function(t,e){const n=e.sync?s:o,c={ns:"",listener:e.watcher,ctx:i,count:0};e.once&&(c.max=1),n.on(t,c),e.immediate&&p(e.watcher,i,[r.get(t),undefined,t])};u(t)?c(t,kt(e,n)):J(t,(function(t,e){c(e,kt(t))}))}unwatch(t,e){let n={ns:"",listener:e};this.syncEmitter.off(t,n),this.asyncEmitter.off(t,n)}toggle(t){const e=!this.get(t);return this.set(t,e),e}increase(t,e,n){const r=wt(this.get(t),0)+(e||1);if(!f(n)||r<=n)return this.set(t,r),r}decrease(t,e,n){const r=wt(this.get(t),0)-(e||1);if(!f(n)||r>=n)return this.set(t,r),r}insert(t,e,n){let r=this.get(t);r=o(r)?tt(r):[];const{length:i}=r;if(true===n||n===i)r.push(e);else if(false===n||0===n)r.unshift(e);else{if(!(n>0&&n<i))return;r.splice(n,0,e)}return this.set(t,r),true}append(t,e){return this.insert(t,e,true)}prepend(t,e){return this.insert(t,e,false)}removeAt(t,e){let n=this.get(t);if(o(n)&&e>=0&&e<n.length)return n=tt(n),n.splice(e,1),this.set(t,n),true}remove(t,e){let n=this.get(t);if(o(n)&&(n=tt(n),E(n,e)))return this.set(t,n),true}copy(t,e){return tt(t,e)}destroy(){const t=this;t.syncEmitter.off(),t.asyncEmitter.off(),t.nextTask.clear(),K(t)}}class jt{constructor(t){const e=this,n=t||r;e.$emitter=new ht(true),n.events&&e.on(n.events);let{data:i,props:o,vnode:u,propTypes:f,computed:a,methods:l,watchers:h,extensions:d}=n;e.$options=n,d&&Q(e,d);const g=o?tt(o):{},v=e.$observer=new Ct(g,e);a&&J(a,(function(t,e){v.addComputed(e,t)}));const y=s(i)?p(i,e,t):i;c(y)&&J(y,(function(t,e){g[e]=t})),l&&J(l,(function(t,n){e[n]=t})),h&&e.watch(h)}static define(t){return t}static use(t){t.install(jt)}static nextTick(t,e){bt.shared().append(t,e)}static compile(t,e){return t}static directive(t,e){}static transition(t,e){}static component(t,e){}static partial(t,e){}static filter(t,e){}get(t,e){return this.$observer.get(t,e)}set(t,e){const{$observer:n}=this;n&&n.set(t,e)}on(t,e){return Rt(this,t,e),this}once(t,e){return Rt(this,t,e,true),this}off(t,e){return this.$emitter.off(t,e),this}fire(t,e,n){const r=this,{$emitter:i,$parent:s,$children:o}=r;let f;if(d.is(t))f=t;else if(u(t))f=new d(t);else{const e=t;f=new d(e.type),f.ns=e.ns}if(undefined===f.ns){const t=i.toEvent(f.type);f.type=t.type,f.ns=t.ns}f.target||(f.target=r);let a,l=[f];return c(e)?b(l,e):true===e&&(n=true),a=!(!n||f.target!==r)||i.fire(f,l),a&&(n?o&&(f.phase=d.PHASE_DOWNWARD,g(o,(function(t){return a=t.fire(f,e,true)}))):s&&(f.phase=d.PHASE_UPWARD,a=s.fire(f,e))),a}watch(t,e,n){return this.$observer.watch(t,e,n),this}unwatch(t,e){return this.$observer.unwatch(t,e),this}loadComponent(t,e){}createComponent(t,e){return this}directive(t,e){}transition(t,e){}component(t,e){}partial(t,e){}filter(t,e){}forceUpdate(t){}render(){}update(t,e){}checkProp(t,e){}destroy(){const{$parent:t,$options:e,$emitter:n,$observer:r}=this;r.destroy(),n.off(),K(this)}nextTick(t){this.$observer.nextTask.append(t,this)}toggle(t){return this.$observer.toggle(t)}increase(t,e,n){return this.$observer.increase(t,e,n)}decrease(t,e,n){return this.$observer.decrease(t,e,n)}insert(t,e,n){return this.$observer.insert(t,e,n)}append(t,e){return this.$observer.append(t,e)}prepend(t,e){return this.$observer.prepend(t,e)}removeAt(t,e){return this.$observer.removeAt(t,e)}remove(t,e){return this.$observer.remove(t,e)}copy(t,e){return this.$observer.copy(t,e)}}function Pt(t,e,n,r){const{$emitter:i}=t,s=i.toFilter(e,n),o={listener:s.listener,ns:s.ns,ctx:t};r&&(o.max=1),t.$emitter.on(s.type,o)}function Rt(t,e,n,r){u(e)?Pt(t,e,n,r):J(e,(function(e,n){Pt(t,n,e,r)}))}jt.version="1.0.0-alpha.125",jt.is=h,jt.array=A,jt.object=rt,jt.string=I,jt.logger=lt,jt.Event=d,jt.Emitter=ht;export default jt;
//# sourceMappingURL=yox.esm.min.js.map
